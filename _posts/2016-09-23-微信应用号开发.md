---
title:  "微信应用号开发"
date:   2016-07-29 16:00:00 +0800
categories: [前端]
tags: [微信应用号,前端]
---

[下载demo](https://github.com/CurtisCBS/wx-app)

文件目录结构

配置好appid，项目名称，选择一个空项目文件夹，微信开发者

工具就会帮你生成项目的初始化文件(如下图)

![image]({{"images/post/20160923/init-file-instruct.png" | prepend: site.baseurl }})

pages是页面文件的目录，里面每个文件夹代表一个页面。

        一个页面包涵一个js文件，一个wxml（可以看作html），一个wxss（可以看作css文件）

utils用于存放工具或者公用方法。

app.js是应用号的主入口。这里可以通过app的生命周期做业务处理。

    App({
      onLaunch: function () {
        //调用API从本地缓存中获取数据
        var logs = wx.getStorageSync('logs') || []
        logs.unshift(Date.now())
        wx.setStorageSync('logs', logs)
      },
      getUserInfo:function(cb){
        var that = this;
        if(this.globalData.userInfo){
          typeof cb == "function" && cb(this.globalData.userInfo)
        }else{
          //调用登录接口
          wx.login({
            success: function () {
              wx.getUserInfo({
                success: function (res) {
                  that.globalData.userInfo = res.userInfo;
                  typeof cb == "function" && cb(that.globalData.userInfo)
                }
              })
            }
          });
        }
      },
      globalData:{
        userInfo:null
      }
    })

app.json是当前项目的目录配置

app.wxss是公用的样式文件

第一个页面
---
在项目初始化时候已经在/project/pages/index目录下创建了应用程序的首页

index.js文件
    var app = getApp()
    Page({
      data: {
        motto: 'Hello World',
        userInfo: {}
      },
      //事件处理函数
      bindViewTap: function() {
        wx.navigateTo({
          url: '../logs/logs'
        })
      },
      onLoad: function () {
        console.log('onLoad')
        var that = this
        //调用应用实例的方法获取全局数据
        app.getUserInfo(function(userInfo){
          //更新数据
          that.setData({
            userInfo:userInfo
          })
          that.update()
        })
      }
    })

data是在index.wxml里面能够渲染的数据

bindViewTap是提供给wxml元素节点用于绑定触发的

      <view  bindtap="bindViewTap" class="userinfo">

onLoad是当前页面的加载完触发的生命周期函数

下面实现一个简单的页面(效果图)

![image]({{"images/post/20160923/view.png" | prepend: site.baseurl }})

index.js文件

    //获取应用实例
    var app = getApp();
    Page({
      data: {
        indicatorDots: true,
        vertical: false,
        autoplay: true,
        interval: 3000,
        duration: 1000,
        thumbArrar:[
          {
            url:"http://www.chenbingshu.com",
            image:"image/thumb_1.png"
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/thumb_2.png"
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/thumb_3.png"
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/thumb_4.png"
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/thumb_5.png"
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/thumb_6.jpg"
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/thumb_7.png"
          }
        ],
        iconArray:[
          {
            url:"http://www.chenbingshu.com",
            image:"image/icon_2.png"
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/icon_1.png",
            title:""
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/icon_3.png"
          },
          {
            url:"http://www.chenbingshu.com",
            image:"image/icon_4.png"
          }
        ],
        swiperArray:[
          {
            bgColor:'green',
            image:'image/banner_1.png'
          },
          {
            bgColor:'red',
            image:'image/banner_2.png'
          },
          {
            bgColor:'yellow',
            image:'image/banner_3.png'
          }
        ]
      }
    });

index.wxml文件
<!--index.wxml-->

    <view class="container">
      <view class="section section_gap swiper">
            <!--swiper-->
            <swiper style="height:200px;" indicator-dots="{{indicatorDots}}" vertical="{{vertical}}" autoplay="{{autoplay}}" interval="{{interval}}" duration="{{duration}}">
                <block wx:for-items="{{swiperArray}}">
                    <swiper-item>
                        <view class="swiper-item bc_{{item.bgColor}}">
                            <image class="swiper-pic" src="{{item.image}}"></image>
                        </view>
                    </swiper-item>
                </block>
            </swiper>
            <!--icon-->
            <view class="clearfix icon-view">
                <view class="icon-item" wx:for-items="{{iconArray}}">
                    <image style="width:40px;height:40px;" class="icon" src="{{item.image}}"></image>
                </view>
            </view>
            <view class="clearfix">
                <view class="wrap">
                    <view class="fleft" style="width:50%;" wx:for-items="{{thumbArrar}}">
                        <view class="small-wrap">
                            <view class="small-wrap white-bg image-box">
                                <image style="width:100%;" class="icon" src="{{item.image}}"></image>
                            </view>
                        <view class="wrap">
                    </view>
                </view>
            </view>
        </view>
    </view>

[下载demo](https://github.com/CurtisCBS/wx-app)
